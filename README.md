## Работа с StudentDoc-Builder

Программа предназначена для работы с данными об успеваемости студентов, содержащихся в Access таблицах.

**Программа имеет опции:**
- запись статистики (данные о среднем балле, кол-ве 5, кол-ве 4, кол-ве 3 заносится в последние 4 строки таблицы);
- создание документа "Справка ПО ВО" (создает документ по шаблону для каждого студента группы, в котором отражается успеваемость студента по каждому предмету за все года обучения);
- создание документа "личная справка" (создает документ с контактной информацией о студенте и его успеваемости по каждому году обучения);
- создание документа "портфолио" (создает документ-портфолио ученика, включающее данные об успеваемости, курсовых, спортивных достижениях и т.д.).

**Составлающие программы:**
1) Поле для выбора БД (выбрать можно только access файлы)
2) Выбор конкретной таблицы (представлен в виде listbox с перечнем таблиц, которые содержатся в БД без учета таблиц: системных, с меткой 'D=', временных)
3) Выбор опции работы (также представлен в виде listbox, который включает в себя запись статистики, создание шаблонов документов)
4) Поле для выбора папки вывода (в этой папке будут отображаться созданные файлы)
5) Логи программы (панель, расширяющая изначальную форму и отображающая ход выполнения программы. Следует использовать для отслеживания неожиданных исключений, которые не были выявлены файлом Exception.cs)

![preview](https://github.com/user-attachments/assets/313bba18-ade0-4f23-a12d-322b153cd3be)
Переключаться между элементами списка рекомендуется не прокруткой колеса мыши, а через клавиши ↑↓ (это значительно удобней в рамках программы).

Для корректной работы **переместите папку Template (_Docs папка_) в директорию исполнямого файла** (папка с .exe файлом). Данный файл включает в себя шаблоны документов, на основе которых работают алгоритмы программы для формирования отчетных документов.

Если у вас не установлен [NET SDK](https://dotnet.microsoft.com/ru-ru/download), то рекомендуется это сделать.

## Требования к таблицам Access

StudentDoc-Builder работает с Access таблицами, что накладывает ряд ограничений на оформление таблиц. Например, алгоритмы программы берут данные из конкретных столбцов
(_такие функции, как: **ConvertToNubmer(column)**, **GetColumnValue(column)**, и прочие_). И если таблица не будет соответствовать шаблону - программа будет получать неверные данные.

**Таблицы разделяются на два типа**: успеваемость группы, данные о дисциплинах группы (метка 'D=').

**Таблица успеваемости имеет следующий шаблон**: [Номер, Дисциплина, ФИО1, ФИО2, ..., ФИО N].

**Таблица дисциплин группы имеет следующий шаблон**: [Номер, Код, Дисциплина, Семестр, Отведенные часы, З.Е., К.Е.].

### Пример заполненных таблиц
![accessTable1](https://github.com/user-attachments/assets/d0171488-ea71-4d96-8a45-e7005dd8209f)
![accessTable2](https://github.com/user-attachments/assets/105688eb-1511-48e7-ba50-b3da377b865f)

Протестировать механизмы взаимодейтсвия с таблицами (правильные и неправильные варианты записи) можно, используя **Access файл из папки Docs** (спец. папка с дополнительными материалами).

### Особенности таблиц

При оформлении таблиц успеваемости можно оставлять пустые поля на местах оценок, поскольку те преобразуются в "Не оценено" в отчетах. Таким образом, можно создавать шаблоны документа
для еще не окончивших весь план обучения учеников.

При заполнении таблицы рекомендуется придерживаться последовательной записи относительно дисциплин (семестр к семетру, от первого к самому последнему).

Таблицу дисциплин необходимо помечать меткой '**D=**'. Например, для '20-ПИ-01' такая таблица будет иметь название 'D=20-ПИ-01'. Это необходимо для того, чтобы в общем списке таблиц пользователь не выбирал
случайным образом не тот формат таблицы, что нарушало бы работу. Помимо этого, это сокращает список и позволяет быстрее найти нужную таблицу.

Вы можете настраивать разные типы данных для столбцов так, как программа преобразует их в string тип, а затем работает с ними в зависимости от выбранной опции.

Таким образом, таблицы имеют строгое оформление, но при этом неопытный пользователь может создать рабочий Access файл (Ему не надо будет настраивать свойства полей, типы данных в конструкторе).

## Запись статистики

Опция программы, предназначенная для сбора общей статистики успеваемости по группе. "Запись статистики" позволяет получить данные средних оценок, количество отличных, хороших и удовлетворительных оценок.
Это единственная опция, которая работает непосредственно с Access и изменяет содержимое файла БД. Поэтому при обращении с этой опцией следует быть внимательным.

Прежде всего, **необходимо выделить 4 строки таблицы успеваемости под запись** этих данных. В противном случае могут быть перезаписаны нужные данные, что в последующем повлияет на точность результатов или
на вывод ошибки "Не совпадает кол-во дисциплин в двух таблицах".

Еще одна особенность в том, что нет надобности в заполнении поля, в котором указывается путь к папке-вывода. В других ситуациях - это поле обязательно.

### Пример работы опции
![stats](https://github.com/user-attachments/assets/22681866-3c0f-4f39-bf64-16fe913a0cd0)

## Справка ПО ВО

Выбрав эту опцию, можно будет создать документ шаблона "Справка ПО ВО" для каждого студента группы.

**В алгоритме создания документов этого типа учитывается ряд факторов**:
- сортировка на ФТД дисциплины (факультативные дисциплины, которые требуется писать отдельно);
- возможность подсчета суммы З.Е. (без учета ФТД), а также К.Е.;
- вывод оценок не в числовом формате, а в виде текста;
- поддержка вывода уникальных актуальных дисциплин (если есть математика за 1 и 2 семестр, то выводится будет оценка за последний семестр, то есть актуальная оценка).

### Пример создаваемого документа
![wordfile1](https://github.com/user-attachments/assets/f4ef2d24-a1b1-4c36-a080-b01765ce7f13)

Титульная страница берется из папки Template, которая содержится в директории вместе с .exe файлом. Из шаблонного документа происходит замена только ФИО студента, поскольку иных данных о студентах нет.

Сами таблицы создаются с нуля с помощью библиотеки **Free Spire.Doc**, предназначенной для работы с Word файлами.
Алгоритм создания можно просмотреть в 'Views->CreateDocument.cs', начиная с метода CreateReference.

## Портфолио

Данная опция формирует документы типа "Портфолио" для каждого студента, закрепленного в группе.

**Портфолио включает в себя**:
- титульный лист и крадкую сводку информации о студенте;
- таблицы, включающие оценки по каждому предмету за каждый семестр;
- таблицы, включающие данные о курсовых и практиках;
- иные таблицы (которые генерируются пустыми), предназаченные для записи об участии в конкурсах, спортивных достижениях, прочие достижения студента.

### Пример создаваемого документа
![portfolio_example1](https://github.com/user-attachments/assets/dc2cec95-409a-44d1-a58d-ec65af94b43e)
![portfolio_example2](https://github.com/user-attachments/assets/909a841b-2d23-4e11-95cd-3aef2dabac4e)

## Личная карточка

При выборе этой опции формируется шаблон типа "Личная-карточка". Как и предыдущие опции, "личная карточка" формирует ряд документов по целевой группе в выделенной для этого папке.

**Личная карточка содержит**:
- данные о дипломной работе (когда выдан, тема, оценка, приказ);
- контактные данные студента;
- успеваемость по каждому году (для каждого года формируется отдельная таблица).

### Пример создаваемого документа
![PersonalCard1](https://github.com/user-attachments/assets/586a4efa-f3b8-4e45-864a-bad437664796)
![PersonalCard2](https://github.com/user-attachments/assets/c039dcb7-e9d9-437e-8381-8558a7ff0814)


## Типы исключений Exception.cs

**Ошибки интерфейса:**
1) Не была выбрана база данных [I01]
2) Не выбрана таблица, принадлежащая выбранному Access файлу [I02]
3) Не выбран формат вывода для создаваемых документов [I03]
4) Не была выбрана папка, в которой будут сохранены результаты преобразований [I04]

**Ошибки оформления таблиц**
1) Недостаточно строк в таблице. Выделите больше пространства для {имя таблицы} [T01]
2) Выбранная таблица слишком мала для перезаписи статистических данных. Выделите последние четыре строки для записи статистики [T02]
3) Не существует таблицы с меткой D= для выбранной таблицы [T03]
4) Имеются расхождения в количестве дисцилин между таблицами. Проверьте строки на соответствие: кол-во дисциплин (без учета 4 полей статистики) для {имя таблицы} = кол-ву дисциплин для таблицы с меткой D={имя таблицы} [T04]
5) Имеются расхождения в наименовании дисциплин. Рекомендуем сверить наименование в выбранной таблице с аналогочной таблицей D={имя таблицы} в строке {номер строки} [T05]
6) Некоторые данные таблицы в столбце {номер столбца} имеют неккорректные значения [T06]
7) Таблица D={имя таблицы} не соотвествует формату: [Номер, Код, Дисциплины, Семестр, Отведенные часы, З.Е., К.Е.] [T07]
8) Таблица D={имя таблицы} имеет некорректные значения в столбце {номер столбца} [T08]
9) Семестры в D={имя таблицы} имеют неупорядоченный вид [T09]

**Ошибка T01**, которая возникает в случаях, когда таблица слишком мала для записи (то есть количество полей таблицы меньше, чем 4 (количество полей статистики)).

**Ошибка T02** имеет схожую причину, но возникает в случаях целенаправленной перезаписи данных (то есть при выборе "запись статистики").

**Ошибка T03** появляется в ситуациях, когда не существует таблицы с перечнем дисциплин для группы. В качестве решения - необходимо создать таблицу с меткой 'D=' и заполнить ее.

**Ошибка T04** срабатывает в случаях, если количество ожидаемых строк из двух таблиц различается. К примеру, если в таблице успеваемости хранятся данные о 3 предметах, а в таблице дисциплин - 4, то возникнет ошибка.
В качестве решения следует уравнять количество строк (при этом в таблице успеваемости последние 4 строки по-прежнему должны быть выделены под статистику).

**Ошибка T05**. Алгоритм в Exception.cs проверяет дисциплины на совпадения по наименованию, чтобы не допускать разрозненности данных (чтобы математика не была записана, как физика). Если данныя ошибка возникнет,
то обратите внимание на строку ее возникновения и устраните несовпадение.

**Ошибка T06** указывает на то, что в таблице успеваемости хранятся недопустимые данные. К допустимым данным можно отнести: 3, 4, 5, зач, незач, пустая-строка. Иные параметры не обрабатываются методом
ConvertToFullString(column), который преобразует данные таблицы согласно словарю. В случае возникновения обратите внимание на столбец возникновения ошибки и найдите некорректные записи.

**Ошибка T07** говорит о том, что таблица дисциплин имеет неправильный формат. Алгоритм проверяет таблицу на совпадение по столбцам (таблица должна иметь 7 столбцов). Если это не так, то это означает либо
нехватку данных, либо их перенасыщение. Для устранения ошибки необходимо скорректировать таблицу по шаблону.

**Ошибка T08** отлавливает некорректные значения в столбце таблицы дисциплин. Таковыми данными являются пустые значения или значения, которые нельзя преобразовать в числовой тип данных (проверка идет по столбцам [Семестр, Отведенные часы, З.Е., К.Е.]).

**Ошибка T09** соообщает о том, что порядок предметов располагается в неупорядоченном виде. Предполагается, что предметы записываются в зависимости от освоения (то есть от первого семестра к последнему). Если у вас возникла эта ошибка, то проверьте таблицу дисциплин на упорядоченность в столбце "Семестры".
